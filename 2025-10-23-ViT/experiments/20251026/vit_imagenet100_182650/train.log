2025-10-26 18:26:50,117 - INFO - Starting Vision Transformer training script
2025-10-26 18:26:50,117 - INFO - Arguments: {'model': 'vit', 'image_size': 224, 'patch_size': 16, 'dim': 384, 'depth': 12, 'heads': 6, 'num_kv_heads': 3, 'mlp_dim': 1536, 'dropout': 0.1, 'emb_dropout': 0.1, 'dim_head': 64, 'pool': 'cls', 'dataset': 'imagenet100', 'data_dir': '../data/imagenet100', 'batch_size': 256, 'num_workers': 8, 'epochs': 300, 'lr': 0.003, 'optimizer': 'adamw', 'weight_decay': 0.3, 'clip_grad_norm': 1.0, 'output_dir': './experiments/20251026/vit_imagenet100_182650', 'resume': None}
2025-10-26 18:26:50,117 - INFO - Distributed training detected: WORLD_SIZE=4, RANK=0
2025-10-26 18:26:50,475 - INFO - Using device: cuda:0, World size: 4, Distributed: True
2025-10-26 18:26:50,999 - INFO - Dataset: imagenet100, Input channels: 3, Classes: 100
2025-10-26 18:26:52,628 - INFO - Using model: vit
2025-10-26 18:26:52,631 - INFO - Using TensorBoard for visualization
2025-10-26 18:26:52,631 - INFO - Weight decay: 0.3, Clip grad norm: 1.0
2025-10-26 18:26:52,631 - INFO - Starting training for 300 epochs
2025-10-26 18:26:52,631 - INFO - Epoch 1/300 (lr=0.003000)
2025-10-26 18:41:38,943 - INFO - Train Loss: 4.3191, Train Acc: 4.12%, Val Loss: 4.1155, Val Acc: 5.28%
2025-10-26 18:41:39,078 - INFO - New best model saved with accuracy: 5.28%
2025-10-26 18:41:39,461 - INFO - Epoch 2/300 (lr=0.003000)
2025-10-26 18:44:45,997 - INFO - Train Loss: 4.0734, Train Acc: 7.23%, Val Loss: 4.0149, Val Acc: 7.28%
2025-10-26 18:44:47,751 - INFO - New best model saved with accuracy: 7.28%
2025-10-26 18:44:51,993 - INFO - Epoch 3/300 (lr=0.003000)
2025-10-26 18:46:33,613 - INFO - Train Loss: 3.9908, Train Acc: 8.39%, Val Loss: 3.9197, Val Acc: 9.76%
2025-10-26 18:46:34,914 - INFO - New best model saved with accuracy: 9.76%
2025-10-26 18:46:42,458 - INFO - Epoch 4/300 (lr=0.002999)
2025-10-26 18:48:22,006 - INFO - Train Loss: 3.8864, Train Acc: 10.31%, Val Loss: 3.8190, Val Acc: 12.00%
2025-10-26 18:48:22,625 - INFO - New best model saved with accuracy: 12.00%
2025-10-26 18:48:24,544 - INFO - Epoch 5/300 (lr=0.002999)
2025-10-26 18:49:45,938 - INFO - Train Loss: 3.7653, Train Acc: 12.26%, Val Loss: 3.6156, Val Acc: 14.88%
2025-10-26 18:49:46,752 - INFO - New best model saved with accuracy: 14.88%
2025-10-26 18:49:51,905 - INFO - Epoch 6/300 (lr=0.002998)
2025-10-26 18:51:15,348 - INFO - Train Loss: 3.6105, Train Acc: 14.81%, Val Loss: 3.4990, Val Acc: 16.96%
2025-10-26 18:51:16,283 - INFO - New best model saved with accuracy: 16.96%
2025-10-26 18:51:18,741 - INFO - Epoch 7/300 (lr=0.002997)
2025-10-26 18:52:40,824 - INFO - Train Loss: 3.4390, Train Acc: 17.98%, Val Loss: 3.2631, Val Acc: 21.36%
2025-10-26 18:52:41,512 - INFO - New best model saved with accuracy: 21.36%
2025-10-26 18:52:43,939 - INFO - Epoch 8/300 (lr=0.002996)
2025-10-26 18:54:06,027 - INFO - Train Loss: 3.2861, Train Acc: 20.65%, Val Loss: 3.1223, Val Acc: 24.72%
2025-10-26 18:54:06,718 - INFO - New best model saved with accuracy: 24.72%
2025-10-26 18:54:08,593 - INFO - Epoch 9/300 (lr=0.002995)
2025-10-26 18:55:30,338 - INFO - Train Loss: 3.1651, Train Acc: 23.58%, Val Loss: 3.0706, Val Acc: 24.24%
2025-10-26 18:55:36,922 - INFO - Epoch 10/300 (lr=0.002993)
2025-10-27 10:44:25,749 - INFO - Starting Vision Transformer training script
2025-10-27 10:44:25,749 - INFO - Arguments: {'model': 'vit', 'image_size': 224, 'patch_size': 16, 'dim': 384, 'depth': 12, 'heads': 6, 'num_kv_heads': 3, 'mlp_dim': 1536, 'dropout': 0.1, 'emb_dropout': 0.1, 'dim_head': 64, 'pool': 'cls', 'dataset': 'imagenet100', 'data_dir': '../data/imagenet100', 'batch_size': 256, 'num_workers': 4, 'epochs': 300, 'lr': 0.001, 'optimizer': 'adam', 'weight_decay': 0.0001, 'clip_grad_norm': 1.0, 'output_dir': 'experiments/20251026/vit_imagenet100_182650', 'resume': 'experiments/20251026/vit_imagenet100_182650/checkpoint_last.pth'}
2025-10-27 10:44:25,749 - INFO - Distributed training detected: WORLD_SIZE=4, RANK=0
2025-10-27 10:44:26,139 - INFO - Using device: cuda:0, World size: 4, Distributed: True
2025-10-27 10:44:26,484 - INFO - Dataset: imagenet100, Input channels: 3, Classes: 100
2025-10-27 10:44:28,149 - INFO - Using model: vit
2025-10-27 10:44:28,151 - INFO - Using TensorBoard for visualization
2025-10-27 10:44:28,151 - INFO - Weight decay: 0.0001, Clip grad norm: 1.0
